<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Part 1.1 Data Preparation and Exploration (Binary Outcomes)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="part1.1_precision_medicine_files/libs/clipboard/clipboard.min.js"></script>
<script src="part1.1_precision_medicine_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="part1.1_precision_medicine_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="part1.1_precision_medicine_files/libs/quarto-html/popper.min.js"></script>
<script src="part1.1_precision_medicine_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="part1.1_precision_medicine_files/libs/quarto-html/anchor.min.js"></script>
<link href="part1.1_precision_medicine_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="part1.1_precision_medicine_files/libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="part1.1_precision_medicine_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="part1.1_precision_medicine_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="part1.1_precision_medicine_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#expected-background-knowledge" id="toc-expected-background-knowledge" class="nav-link active" data-scroll-target="#expected-background-knowledge">1. Expected Background Knowledge</a></li>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">2. Learning Objectives</a></li>
  <li><a href="#key-sections" id="toc-key-sections" class="nav-link" data-scroll-target="#key-sections">3. Key Sections</a>
  <ul class="collapse">
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">1. Summary</a></li>
  <li><a href="#preparation" id="toc-preparation" class="nav-link" data-scroll-target="#preparation">2. Preparation</a></li>
  <li><a href="#descriptive-statistics-and-visualizations" id="toc-descriptive-statistics-and-visualizations" class="nav-link" data-scroll-target="#descriptive-statistics-and-visualizations">3. Descriptive Statistics and Visualizations</a>
  <ul class="collapse">
  <li><a href="#descriptive-summary" id="toc-descriptive-summary" class="nav-link" data-scroll-target="#descriptive-summary">3.1 Descriptive Summary</a></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values">3.2 Missing Values</a></li>
  <li><a href="#distribution-of-numeric-variables" id="toc-distribution-of-numeric-variables" class="nav-link" data-scroll-target="#distribution-of-numeric-variables">3.3 Distribution of Numeric Variables</a></li>
  <li><a href="#distribution-of-categorical-variables" id="toc-distribution-of-categorical-variables" class="nav-link" data-scroll-target="#distribution-of-categorical-variables">3.4 Distribution of Categorical Variables</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation">3.5 Correlation</a></li>
  <li><a href="#relationship-between-predictors-and-response-variables" id="toc-relationship-between-predictors-and-response-variables" class="nav-link" data-scroll-target="#relationship-between-predictors-and-response-variables">3.6 Relationship between Predictors and Response Variables</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><strong>4. Conclusion</strong></a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Part 1.1 Data Preparation and Exploration (Binary Outcomes)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The foundation of any prediction model is understanding and preparing your data. This lesson focuses on cleaning, exploring, and structuring the dataset ‚Äî particularly when the outcome is binary (e.g., disease: yes/no).</p>
<section id="expected-background-knowledge" class="level1">
<h1>1. Expected Background Knowledge</h1>
<ul>
<li>Basic R programming</li>
<li>Basic statistics (means, proportions, distribution)</li>
<li>Familiarity with binary outcomes</li>
</ul>
</section>
<section id="learning-objectives" class="level1">
<h1>2. Learning Objectives</h1>
<ul>
<li>Understand the structure and content of the dataset</li>
<li>Identify and handle missing data</li>
<li>Prepare variables for modeling (e.g., correct formats, imputation)</li>
</ul>
</section>
<section id="key-sections" class="level1">
<h1>3. Key Sections</h1>
<p>In this part, you will learn about :</p>
<ol type="1">
<li>Introduction to the problem</li>
<li>Data Simulation</li>
<li>Descriptive statistics &amp; Exploratory data analysis (EDA)</li>
<li>Handling missing data</li>
<li>Visualizations</li>
</ol>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">1. Summary</h2>
<p>Clinical prediction models aim to forecast future health outcomes given a set of baseline predictors to facilitate medical decision making and improve people‚Äôs health outcomes.</p>
<p>Ideally, prediction models are developed using individual participant data from prospective cohort studies designed for this purpose.</p>
<p>We generated a realistic dataset of 200 patients with 10 predictor variables of mixed types (continuous, binary, and categorical) that exhibit complex relationships including quadratic effects and interactions, representative of real clinical data where variables like age, biomarkers, and treatment indicators are often correlated.</p>
<p>Missing values were introduced randomly across approximately 10% of the data points, mimicking the incomplete data patterns frequently encountered in medical studies due to patient dropout, measurement failures, or administrative issues.&nbsp;</p>
<p>The dataset also includes a clustering structure representing different clinical sites or treatment groups, and a binary outcome variable generated through a logistic regression model with known coefficients.&nbsp;</p>
</section>
<section id="preparation" class="level2">
<h2 class="anchored" data-anchor-id="preparation">2. Preparation</h2>
<p>After opening the R-Studio, we need to load some of the libraries that will be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(correlation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Dataset has been available with 200 rows of patient data that contains 5 predictors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="st">'dataset.rds'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          x1          x2 x3 x4 x5 y
1 -0.2920649 -0.03894024  0  0  3 0
2  0.2585203 -1.10383191  0  0  3 0
3 -0.3255838  0.02113777  1  1  3 0
4  0.7591404  1.20456294  1  0  1 0
5 -0.7619825  0.99184146  1  1  3 0
6  0.3543335  0.74232912  0  0  3 0</code></pre>
</div>
</div>
<p>The dataset included :</p>
<ul>
<li>Five predictors x1, x2, x3, x4, x5, of which x1, x2 are continuous, x3, x4 binary, and x5 categorical.</li>
<li>The outcome y is binary variable ( 0 and 1)</li>
</ul>
</section>
<section id="descriptive-statistics-and-visualizations" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-statistics-and-visualizations">3. Descriptive Statistics and Visualizations</h2>
<p>Before we build any predictive model, it is crucial to thoroughly explore and understand the dataset. This section will guide you through essential descriptive statistics and visualizations to better comprehend the structure, distribution, and relationships within the data.</p>
<section id="descriptive-summary" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-summary">3.1 Descriptive Summary</h3>
<p>Begin by inspecting the structure of the dataset and summarizing its variables using the&nbsp;<code>summary()</code>&nbsp;function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       x1                 x2           x3      x4      x5     y      
 Min.   :-2.72626   Min.   :-3.58266   0:131   0:101   1:31   0:148  
 1st Qu.:-0.59029   1st Qu.:-0.59374   1: 69   1: 99   2:72   1: 52  
 Median : 0.06844   Median : 0.05397                   3:61          
 Mean   : 0.06697   Mean   : 0.06396                   4:36          
 3rd Qu.: 0.73247   3rd Qu.: 0.69973                                 
 Max.   : 2.96170   Max.   : 2.31576                                 </code></pre>
</div>
</div>
<p>Here are the insight breakdown of each variables :</p>
<table class="caption-top table">
<colgroup>
<col style="width: 53%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="header">
<th>Insight</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>x1</code>&nbsp;and&nbsp;<code>x2</code>&nbsp;have medians and means close to 0 ( Indicate Normal Distributions)</td>
<td><p><code>x1</code>: from approximately -2.73 to 2.96<br>
<code>x2</code>: from approximately -3.58 to 2.32</p>
<p>The min and max suggest <strong>no extreme outliers</strong> on both variables</p></td>
</tr>
<tr class="even">
<td><code>x3</code>&nbsp;is slightly imbalanced</td>
<td><p>Has two levels and majority is level 0 :</p>
<p><code>0</code>: 131 observations (65%)<br>
<code>1</code>: 69 observations (35%)</p></td>
</tr>
<tr class="odd">
<td><code>x4</code>&nbsp;is balanced</td>
<td><p>Almost perfectly balanced between each class,</p>
<p><code>0</code>: 101 observations (50%)<br>
<code>1</code>: 99 observations (50%)</p></td>
</tr>
<tr class="even">
<td><code>x5</code>&nbsp;has moderate imbalance</td>
<td>Level 2 has the most frequent observations, and level 1 is the least.</td>
</tr>
<tr class="odd">
<td><code>y (response variable)</code>is imbalanced</td>
<td><p>The response variable has two classes (binary) :</p>
<p>0 : 148 observations (74%)<br>
1 : 52% observations (26%)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="missing-values" class="level3">
<h3 class="anchored" data-anchor-id="missing-values">3.2 Missing Values</h3>
<p>Check for any missing values in the dataset, which could impact model performance if not handled properly. Use&nbsp;<code>is.na()</code>&nbsp;and&nbsp;<code>colSums()</code>&nbsp;or&nbsp;<code>summary()</code>&nbsp;to identify missing data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x1 x2 x3 x4 x5  y 
 0  0  0  0  0  0 </code></pre>
</div>
</div>
<p>This means:</p>
<ul>
<li>Every variable (<code>x1</code>&nbsp;to&nbsp;<code>x5</code>, and&nbsp;<code>y</code>) is fully observed.</li>
<li>No imputation, removal, or special treatment for missing data is needed during preprocessing.</li>
<li>We can proceed directly to data exploration, visualization, and modeling without concern for NA handling.</li>
</ul>
</section>
<section id="distribution-of-numeric-variables" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-numeric-variables">3.3 Distribution of Numeric Variables</h3>
<p>Visualize the distribution of numeric variables using histograms to understand their shapes, spread, and central tendencies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x1)) <span class="sc">+</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of X1"</span>, <span class="at">x =</span> <span class="st">"X1"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x2)) <span class="sc">+</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"lightgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of X2"</span>, <span class="at">x =</span> <span class="st">"X2"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">top =</span> <span class="st">"Distribution of Continuous Variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part1.1_precision_medicine_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Both&nbsp;<code>x1</code>&nbsp;and&nbsp;<code>x2</code>&nbsp;have means and medians close to zero, and the data ranged from -3 to 3, the typical numerical data that follows <strong>Normal Distribution</strong></li>
<li>Since the&nbsp;<strong>mean ‚âà median</strong>&nbsp;for both, there‚Äôs&nbsp;<strong>no strong skew</strong>&nbsp;(neither left nor right). In addition, based on the plot there is no extreme values that considered <em>outliers</em>.</li>
<li>Since both of them has normal distributions, there is no need to apply transformations before going into modelling.</li>
</ul>
</section>
<section id="distribution-of-categorical-variables" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-categorical-variables">3.4 Distribution of Categorical Variables</h3>
<p>Explore the frequency distribution of categorical variables <code>(x3,x4,x5 and y)</code> using bar plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x3)) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of X3"</span>, <span class="at">x =</span> <span class="st">"X3"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x4)) <span class="sc">+</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of X4"</span>, <span class="at">x =</span> <span class="st">"X4"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x5)) <span class="sc">+</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"purple"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of X5"</span>, <span class="at">x =</span> <span class="st">"X5"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> y)) <span class="sc">+</span> </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Outcome Y"</span>, <span class="at">x =</span> <span class="st">"Y"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p5, p6, p7, p8, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">top =</span> <span class="st">"Distribution of Categorical Variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part1.1_precision_medicine_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Based on the plot above, here are some key insights :</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 29%">
<col style="width: 22%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Balanced?</th>
<th>Sparse Levels?</th>
<th>Modelling Challanges</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>x3</code></td>
<td>Slightly imbalanced</td>
<td>No</td>
<td>Minor</td>
</tr>
<tr class="even">
<td><code>x4</code></td>
<td>Yes</td>
<td>No</td>
<td>None</td>
</tr>
<tr class="odd">
<td><code>x5</code></td>
<td>No</td>
<td>Yes (<code>1</code>,&nbsp;<code>4</code>)</td>
<td>Minor</td>
</tr>
<tr class="even">
<td><code>y</code></td>
<td>No (imbalanced)</td>
<td>N/A</td>
<td>Needs special handling</td>
</tr>
</tbody>
</table>
</section>
<section id="correlation" class="level3">
<h3 class="anchored" data-anchor-id="correlation">3.5 Correlation</h3>
<p>Analyze pairwise correlations to understand the linear relationships between variables. Use correlation coefficients (Pearson, Spearman, or Cram√©r‚Äôs V for categorical) and visualize them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cor_result <span class="ot">=</span> rcompanion<span class="sc">::</span><span class="fu">correlation</span>(df)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>cor_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Var1 Var2              Type   N Measure Statistic Lower.CL Upper.CL
1    x1   x2 Numeric x Numeric 200 Pearson     0.486    0.372    0.585
2    x1   x3  Numeric x Binary 200 Pearson     0.168    0.030    0.300
3    x1   x4  Numeric x Binary 200 Pearson    -0.002   -0.141    0.137
4    x1   x5 Numeric x Nominal 200     Eta     0.046    0.000    0.122
5    x1    y  Numeric x Binary 200 Pearson     0.482    0.368    0.582
6    x2   x3  Numeric x Binary 200 Pearson     0.419    0.298    0.527
7    x2   x4  Numeric x Binary 200 Pearson     0.095   -0.044    0.231
8    x2   x5 Numeric x Nominal 200     Eta     0.081    0.000    0.170
9    x2    y  Numeric x Binary 200 Pearson     0.274    0.140    0.397
10   x3   x4   Binary x Binary 200     Phi     0.228       NA       NA
11   x3   x5  Binary x Nominal 200  Cramer     0.168       NA       NA
12   x3    y   Binary x Binary 200     Phi     0.121       NA       NA
13   x4   x5  Binary x Nominal 200  Cramer     0.333       NA       NA
14   x4    y   Binary x Binary 200     Phi    -0.062       NA       NA
15   x5    y  Nominal x Binary 200  Cramer     0.096       NA       NA
         Test p.value Signif
1    cor.test  0.0000   ****
2    cor.test  0.0171      *
3    cor.test  0.9789   n.s.
4       Anova  0.9353   n.s.
5    cor.test  0.0000   ****
6    cor.test  0.0000   ****
7    cor.test  0.1798   n.s.
8       Anova  0.7291   n.s.
9    cor.test  0.0001   ****
10 chisq.test  0.0013     **
11 chisq.test  0.1297   n.s.
12 chisq.test  0.0862   n.s.
13 chisq.test  0.0001   ****
14 chisq.test  0.3770   n.s.
15 chisq.test  0.6037   n.s.</code></pre>
</div>
</div>
<p>The correlation Plot :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cor_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part1.1_precision_medicine_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Based on the summary and the plot above, there are some insights that will be useful for modelling :</p>
<p><strong>üî∏ Significance Legend:</strong></p>
<ul>
<li><code>****</code>&nbsp;= p &lt; 0.0001 ‚Üí highly significant</li>
<li><code>**</code>&nbsp;= p &lt; 0.01 ‚Üí very significant</li>
<li><code>*</code>&nbsp;= p &lt; 0.05 ‚Üí significant</li>
<li><code>n.s.</code>&nbsp;= not significant</li>
</ul>
<p>There are some variables that has significant correlations between each other :</p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 13%">
<col style="width: 41%">
</colgroup>
<thead>
<tr class="header">
<th>Pair</th>
<th>Correlation</th>
<th>Strength</th>
<th>Significance</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>x1</code>&nbsp;~&nbsp;<code>x2</code></td>
<td>0.486</td>
<td>Moderate</td>
<td>****</td>
<td>Moderate positive linear relationship</td>
</tr>
<tr class="even">
<td><code>x1</code>&nbsp;~&nbsp;<code>y</code></td>
<td>0.482</td>
<td>Moderate</td>
<td>****</td>
<td><code>x1</code>&nbsp;is moderately predictive of the outcome</td>
</tr>
<tr class="odd">
<td><code>x2</code>&nbsp;~&nbsp;<code>y</code></td>
<td>0.274</td>
<td>Weak-to-moderate</td>
<td>****</td>
<td>Some predictive power, less than&nbsp;<code>x1</code></td>
</tr>
<tr class="even">
<td><code>x1</code>&nbsp;~&nbsp;<code>x3</code></td>
<td>0.168</td>
<td>Weak</td>
<td>*</td>
<td>Weak positive correlation</td>
</tr>
<tr class="odd">
<td><code>x2</code>&nbsp;~&nbsp;<code>x3</code></td>
<td>0.419</td>
<td>Moderate</td>
<td>****</td>
<td><code>x2</code>&nbsp;and&nbsp;<code>x3</code>&nbsp;have moderate relationship</td>
</tr>
<tr class="even">
<td><code>x4</code>&nbsp;~&nbsp;<code>x5</code></td>
<td>0.333</td>
<td>Moderate</td>
<td>****</td>
<td>Strongest categorical relationship in data</td>
</tr>
<tr class="odd">
<td><code>x3</code>&nbsp;~&nbsp;<code>x4</code></td>
<td>0.228</td>
<td>Weak-to-moderate</td>
<td>**</td>
<td>Some association between&nbsp;<code>x3</code>&nbsp;and&nbsp;<code>x4</code></td>
</tr>
</tbody>
</table>
</section>
<section id="relationship-between-predictors-and-response-variables" class="level3">
<h3 class="anchored" data-anchor-id="relationship-between-predictors-and-response-variables">3.6 Relationship between Predictors and Response Variables</h3>
<p>Explore how the predictor variables relate to the response variable. This can reveal early signs of predictive power and potential modeling strategies.</p>
<section id="numerical-predictors-vs-response-variables" class="level4">
<h4 class="anchored" data-anchor-id="numerical-predictors-vs-response-variables">3.6.1 Numerical Predictors vs Response Variables</h4>
<p>Use boxplots to assess the relationship between continuous predictors and the response variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p10 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> y, <span class="at">y =</span> x1, <span class="at">fill =</span> y)) <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"X1 by Outcome Y"</span>, <span class="at">x =</span> <span class="st">"Y"</span>, <span class="at">y =</span> <span class="st">"X1"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> y, <span class="at">y =</span> x2, <span class="at">fill =</span> y)) <span class="sc">+</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"X2 by Outcome Y"</span>, <span class="at">x =</span> <span class="st">"Y"</span>, <span class="at">y =</span> <span class="st">"X2"</span>) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p10, p11, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">top =</span> <span class="st">"Continuous Predictors by Outcome"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part1.1_precision_medicine_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here are some key takeaways from the plot :</p>
<p>For X1 and Y :</p>
<ul>
<li>Median of <code>x1</code>is higher for <code>y = 1</code> compared to <code>y = 0</code>.</li>
<li>Individuals with higher&nbsp;<code>x1</code>&nbsp;values are more likely to have&nbsp;<code>y = 1</code> (Indicate that there is <strong>moderate relationship between x1 and y</strong>, confirmed by the correlation value (0.482) with very high significance).</li>
</ul>
<p>For X2 and Y :</p>
<ul>
<li>Median of <code>x2</code>for <code>y = 1</code> is also higher than for <code>y = 0</code></li>
<li>The <strong>trend is upward</strong>, indicating that <code>x2</code> may be somewhat predictive of <code>y</code>, confirmed by the positive correlation value (0.274) with high significance</li>
</ul>
</section>
<section id="categorical-predictors-vs-response-variables" class="level4">
<h4 class="anchored" data-anchor-id="categorical-predictors-vs-response-variables">3.6.2 Categorical Predictors vs Response Variables</h4>
<p>Use grouped bar plots to explore how categorical predictors influence the response.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="st">"x3"</span>, <span class="at">fill =</span> <span class="st">"factor(y)"</span>)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span>  <span class="co"># stacked proportion bars</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Proportion"</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"y"</span>, <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"X3 by Outcome Y"</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
‚Ñπ Please use tidy evaluation idioms with `aes()`.
‚Ñπ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>p13 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="st">"x4"</span>, <span class="at">fill =</span> <span class="st">"factor(y)"</span>)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span>  <span class="co"># stacked proportion bars</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Proportion"</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"y"</span>, <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"X4 by Outcome Y"</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>p14 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes_string</span>(<span class="at">x =</span> <span class="st">"x5"</span>, <span class="at">fill =</span> <span class="st">"factor(y)"</span>)) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span>  <span class="co"># stacked proportion bars</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Proportion"</span>) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"y"</span>, <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"X5 by Outcome Y"</span>)) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p12, p13, p14, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">top =</span> <span class="st">"Categorical Predictors by Outcome"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="part1.1_precision_medicine_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the bar plots titled&nbsp;<strong>‚ÄúCategorical Predictors by Outcome‚Äù</strong>, we can analyze how the response variable&nbsp;<code>y</code>&nbsp;(0 or 1) is distributed across levels of the categorical predictors:&nbsp;<code>x3</code>,&nbsp;<code>x4</code>, and&nbsp;<code>x5</code>.</p>
<ul>
<li>in every variables, majority of cases have <code>y = 0</code> (orange) with smaller proportion of <code>y = 1</code> (blue)</li>
<li>All the categorical variables have low correlations with the y. Thus, there is <strong>no categorical variables that has significant relationship with Y</strong>, indicated by high p-values and low correlation. That‚Äôs why no clear or strong association captured by the graph.</li>
</ul>
</section>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1><strong>4. Conclusion</strong></h1>
<p>From the exploratory analysis, we found that the numeric predictors&nbsp;<code>x1</code>&nbsp;and&nbsp;<code>x2</code>&nbsp;show meaningful relationships with the outcome&nbsp;<code>y</code>, with&nbsp;<code>x1</code>&nbsp;being the strongest predictor, as supported by both correlation coefficients and clear separation in boxplots. In contrast, the categorical variables&nbsp;<code>x3</code>,&nbsp;<code>x4</code>, and&nbsp;<code>x5</code>&nbsp;show weak or no significant associations with the outcome, with only&nbsp;<code>x3</code>&nbsp;displaying a mild visual trend that is not statistically significant. Additionally, all variables are complete with no missing values, and the data appears standardized. Overall,&nbsp;<code>x1</code>&nbsp;and&nbsp;<code>x2</code>&nbsp;are likely the most valuable predictors for modeling&nbsp;<code>y</code>, while the categorical variables may contribute little to model performance.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>